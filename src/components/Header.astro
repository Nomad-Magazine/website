---
import IsIconDownOutline from '~icons/lsicon/down-outline'
import CloseIcon from '~icons/material-symbols-light/close'
import MenuIcon from '~icons/material-symbols-light/menu-rounded'

const navLinks = [
  {
    text: 'Newsletter',
    url: '/newsletter',
    imageUrl: '/images/1ceec489-3480-49ac-beb7-924dfafe85e5.svg',
  },
  {
    text: 'Our Story',
    url: '/our-story',
    imageUrl: '/underline.svg',
  },
]
---

<header class="relative z-[120] bg-white">
  <div class="mx-auto max-w-7xl px-4">
    <div class="flex items-center justify-between py-8">
      <!-- Logo and Navigation -->
      <div class="flex items-center space-x-10">
        <a href="/" class="text-4xl font-black tracking-tighter text-gray-900">
          <img decoding="async" loading="lazy" src="/logo.svg" alt="n::.m" class="h-6" />
        </a>
        <nav class="hidden space-x-10 lg:flex">
          <div class="relative">
            <button id="magazine-button" class="group flex cursor-pointer items-center text-lg font-bold text-gray-900 transition-colors hover:text-yellow-600">
              <span>Magazine</span>
              <IsIconDownOutline class="ml-1 h-5 w-5 font-bold" />
            </button>
            <div id="magazine-dropdown" class="absolute z-10 mt-2 hidden w-64 rounded-md border border-gray-200 bg-white py-1 shadow-xl">
              <a href="/third-edition" class="flex items-center px-4 py-3 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">
                <span class="mr-3 inline-flex items-center rounded-full bg-gradient-to-r from-yellow-400 to-yellow-500 px-2.5 py-1 text-xs font-bold text-black shadow-sm ring-1 ring-yellow-300/50">NEW</span>
                Edition #3 - Mind. Body. Tech.
              </a>
              <a href="/products/issue-002" class="block px-4 py-3 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Edition #2 - Digital Nomad Communities</a>
              <a href="/products/issue-001" class="block px-4 py-3 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Edition #1 - Digital Nomadism</a>
              <div class="border-t border-gray-200 my-1"></div>
              <a href="/editions" class="block px-4 py-3 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">View All Editions</a>
            </div>
          </div>
          {
            navLinks.map((link) => (
              <a href={link.url} class="group relative inline-block text-lg font-bold text-gray-900 transition-colors hover:text-yellow-600">
                <span>{link.text}</span>
                <img src={link.imageUrl} alt="underline design" class="absolute left-0 hidden w-full group-hover:block" loading="lazy" />
              </a>
            ))
          }
          <div class="relative">
            <button id="more-button" class="flex cursor-pointer items-center text-lg font-bold text-gray-900 transition-colors hover:text-yellow-600">
              More
              <IsIconDownOutline class="ml-1 h-5 w-5 font-bold" />
            </button>
            <div id="more-dropdown" class="absolute z-10 mt-2 hidden w-48 rounded-md border border-gray-200 bg-white py-1 shadow-xl">
              <a href="/nomad_directory" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Nomad Directory</a>
              <a href="/nomad-events" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Events</a>
              <a href="/blog" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Blog</a>
              <a href="/horoscope" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Horoscope</a>
              <a href="/distribution-list" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Distribution Partners</a>
              <a href="/support-the-magazine" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Become a supporter</a>
              <a href="/free-weekly-articles" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Free Articles</a>
              <a href="/add-testimonials" class="block px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-yellow-50 hover:text-yellow-600">Submit Review</a>
            </div>
          </div>
        </nav>
      </div>
      <!-- Buttons -->
      <div class="hidden items-center space-x-4 lg:flex">
        <a href="/support-the-magazine" class="rounded-lg border-2 border-gray-900 px-6 py-3 font-bold text-gray-900 transition-colors hover:bg-gray-900 hover:text-white">
          Become a Supporter ðŸ‘‹
        </a>
        <a
          target="_self"
          href="/third-edition"
          class="rounded-lg border-2 border-yellow-400 bg-yellow-400 px-6 py-3 font-black text-black shadow-lg transition-colors hover:border-yellow-500 hover:bg-yellow-500"
        >
          Buy Latest Edition ðŸ¤“
        </a>
      </div>
      <!-- Mobile menu button -->
      <div class="lg:hidden">
        <button id="mobile-menu-button" type="button" class="text-gray-900 hover:text-yellow-600">
          <MenuIcon class="h-8 w-8" />
        </button>
      </div>
    </div>
  </div>
  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu-overlay" class="fixed inset-0 z-50 hidden bg-black text-white overflow-y-auto">
    <div class="flex items-center justify-between p-6 border-b border-gray-800">
      <a href="/" class="text-4xl font-black tracking-tighter">
        <img decoding="async" loading="lazy" src="/images/logo white png.png" alt="n::.m" class="h-8" />
      </a>
      <button id="close-menu-button" class="hover:text-yellow-400 transition-colors">
        <CloseIcon class="h-8 w-8" />
      </button>
    </div>
    <nav class="flex flex-col space-y-6 p-6 text-lg font-semibold min-h-0">
      <div class="space-y-3">
        <div class="text-yellow-400 text-xl font-bold">Magazine</div>
        <div class="ml-4 space-y-3 text-base">
          <a href="/third-edition" class="flex items-center transition-colors hover:text-yellow-400">
            <span class="mr-3 inline-flex items-center rounded-full bg-gradient-to-r from-yellow-400 to-yellow-500 px-2 py-0.5 text-xs font-bold text-black shadow-sm">NEW</span>
            Edition #3 - Mind. Body. Tech.
          </a>
          <a href="/products/issue-002" class="block transition-colors hover:text-yellow-400">Edition #2 - Digital Nomad Communities</a>
          <a href="/products/issue-001" class="block transition-colors hover:text-yellow-400">Edition #1 - Digital Nomadism</a>
          <div class="border-t border-gray-700 my-2 pt-2">
            <a href="/editions" class="block transition-colors hover:text-yellow-400">View All Editions</a>
          </div>
        </div>
      </div>
      <a href="/newsletter" class="transition-colors hover:text-yellow-400">Newsletter</a>
      <a href="/our-story" class="transition-colors hover:text-yellow-400">Our Story</a>
      <div class="space-y-3">
        <div class="text-yellow-400 text-xl font-bold">More</div>
        <div class="ml-4 space-y-3 text-base">
          <a href="/nomad_directory" class="block transition-colors hover:text-yellow-400">Nomad Directory</a>
          <a href="/nomad-events" class="block transition-colors hover:text-yellow-400">Events</a>
          <a href="/blog" class="block transition-colors hover:text-yellow-400">Blog</a>
          <a href="/horoscope" class="block transition-colors hover:text-yellow-400">Horoscope</a>
          <a href="/distribution-list" class="block transition-colors hover:text-yellow-400">Distribution Partners</a>
          <a href="/support-the-magazine" class="block transition-colors hover:text-yellow-400">Become a supporter</a>
          <a href="/free-weekly-articles" class="block transition-colors hover:text-yellow-400">Free Articles</a>
          <a href="/add-testimonials" class="block transition-colors hover:text-yellow-400">Submit Review</a>
        </div>
      </div>
    </nav>
    <div class="p-6 mt-auto border-t border-gray-800">
      <a href="/products/issue-002" class="block w-full rounded-lg bg-yellow-400 py-4 text-center font-black text-black shadow-lg transition-colors hover:bg-yellow-500"
        >Order Now</a
      >
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Magazine dropdown functionality
    const magazineButton = document.getElementById('magazine-button')
    const magazineDropdown = document.getElementById('magazine-dropdown')
    if (magazineButton && magazineDropdown) {
      let closeTimeout: number | null = null
      
      // Open dropdown on hover
      magazineButton.addEventListener('mouseenter', () => {
        if (closeTimeout) {
          clearTimeout(closeTimeout)
          closeTimeout = null
        }
        magazineDropdown.classList.remove('hidden')
      })
      
      // Close dropdown when mouse leaves the button
      magazineButton.addEventListener('mouseleave', (event) => {
        // Check if mouse is moving to dropdown
        const relatedTarget = event.relatedTarget as Node
        if (!magazineDropdown.contains(relatedTarget)) {
          closeTimeout = window.setTimeout(() => {
            magazineDropdown.classList.add('hidden')
          }, 150) // 150ms delay
        }
      })
      
      // Keep dropdown open when hovering over it
      magazineDropdown.addEventListener('mouseenter', () => {
        if (closeTimeout) {
          clearTimeout(closeTimeout)
          closeTimeout = null
        }
      })
      
      // Close dropdown when mouse leaves dropdown
      magazineDropdown.addEventListener('mouseleave', () => {
        closeTimeout = window.setTimeout(() => {
          magazineDropdown.classList.add('hidden')
        }, 150) // 150ms delay
      })
      
      // Navigate on click instead of toggling
      magazineButton.addEventListener('click', (event) => {
        event.preventDefault()
        window.location.href = '/editions'
      })
    }
    
    // More dropdown functionality
    const moreButton = document.getElementById('more-button')
    const moreDropdown = document.getElementById('more-dropdown')
    if (moreButton && moreDropdown) {
      moreButton.addEventListener('click', (event) => {
        event.stopPropagation()
        moreDropdown.classList.toggle('hidden')
      })
      document.addEventListener('click', (event) => {
        if (!moreDropdown.contains(event.target as Node) && !moreButton.contains(event.target as Node)) moreDropdown.classList.add('hidden')
      })
    }
    
    // Mobile menu functionality
    const mobileMenuButton = document.getElementById('mobile-menu-button')
    const mobileMenuOverlay = document.getElementById('mobile-menu-overlay')
    const closeMenuButton = document.getElementById('close-menu-button')
    if (mobileMenuButton && mobileMenuOverlay && closeMenuButton) {
      mobileMenuButton.addEventListener('click', () => {
        mobileMenuOverlay.classList.remove('hidden')
      })
      closeMenuButton.addEventListener('click', () => {
        mobileMenuOverlay.classList.add('hidden')
      })
    }
  })
</script>
